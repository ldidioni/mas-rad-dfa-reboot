<h2>Report a new issue</h2>
<form novalidate
      (ngSubmit)="reportIssue()"
      [formGroup]="newIssueForm">
    <mat-form-field>
        <mat-label for="descriptionId">Description</mat-label>
        <input matInput
            id="descriptionId"
            type="text"
            placeholder="Description (required)"
            formControlName="description"
            [ngClass]="{ 'is-invalid': descriptionMessage }" />
        <mat-error>
            {{ descriptionMessage }}
        </mat-error>
    </mat-form-field>
<!--
    <label for="imageUrlId">Image URL</label>
    <input
        id="imageUrlId"
        type="text"
        placeholder="Image URL"
        formControlName="imageUrl"
        [ngClass]="{ 'is-invalid': descriptionMessage }" />
    <span class="invalid-feedback">
        {{ descriptionMessage }}
    </span>
-->
    <div formArrayName="imageUrls">
        <div *ngFor="let imageUrl of imageUrls.controls; let i=index">
            <mat-form-field>
                <mat-label attr.for="{{ 'ImageUrl' + i }}">Image URL</mat-label>
                <input matInput
                    id="{{ 'ImageUrl' + i }}"
                    type="text"
                    placeholder="ImageUrl URL"
                    [formControlName]="i"
                    [ngClass]="{ 'is-invalid': imageUrlMessage }" />
            </mat-form-field>
        </div>
        <mat-error>
            {{ imageUrlMessage }}
        </mat-error>
    </div>
    <button mat-raised-button
        type="button"
        [disabled]="!imageUrls.valid"
        (click)="addImageUrl()">
        Add image
    </button>

    <mat-form-field>
        <mat-label for="typeId">Type</mat-label>
        <mat-select
            id="typeId"
            formControlName="issueType">
            <mat-option *ngFor="let issueType of issueTypes" [value]="issueType.href">
                {{ issueType.name }}
            </mat-option>
        </mat-select>
        <mat-error>
            {{ issueTypeMessage }}
        </mat-error>
    </mat-form-field>

    <mat-form-field>
        <mat-chip-list #chipList formControlName="tags">
            <mat-label for="tagsId">Tags</mat-label>
            <mat-chip *ngFor="let tag of tags" [selectable]="selectable"
                [removable]="removable" (removed)="removeTag(tag)">
                {{tag}}
                <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
            </mat-chip>
            <input
                placeholder="New Tag..."
                [matChipInputFor]="chipList"
                [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                [matChipInputAddOnBlur]="addOnBlur"
                (matChipInputTokenEnd)="addTag($event)"
                id="tagsId"
                [ngClass]="{ 'is-invalid': tagsMessage }" />
        </mat-chip-list>
        <mat-error>
            {{ tagsMessage }}
        </mat-error>
    </mat-form-field>

    <button
        mat-raised-button color="primary"
        type="submit"
        [title]="newIssueForm.valid ? 'Submit' : 'Please complete the form'"
        [disabled]="!newIssueForm.valid">
        Register
    </button>

  <!--  <app-issue-map
        (location)="onLocationSet">
    </app-issue-map>-->

    <mat-error>
        {{ locationMessage }}
    </mat-error>
    <app-map
        [mapPoints]="[]"
        [clickable]="true"
        (location)="onLocationSet($event)"
    ></app-map>

</form>


<p>
    Form value: {{ newIssueForm.value | json }}
</p>